<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ITN Mass Campaign Distribution</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="ITN Mass Campaign Distribution System - Sierra Leone">
    <meta name="theme-color" content="#0056a8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ITN Campaign">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ITN Campaign">
    <meta name="msapplication-TileColor" content="#0056a8">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Crect width='48' height='48' rx='6' fill='%230056a8'/%3E%3Ctext x='24' y='33' font-family='Impact,Arial Black,sans-serif' font-size='22' font-weight='900' fill='white' text-anchor='middle'%3EITN%3C/text%3E%3Crect x='8' y='36' width='32' height='3' rx='1.5' fill='%23ffc107'/%3E%3C/svg%3E">
    
    <!-- Oswald Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>

    <!-- ==================== LOGIN SCREEN ==================== -->
    <div class="login-screen" id="loginScreen">
        <div class="page-container">
            <!-- HEADER -->
            <div class="page-header">
                <div class="header-logos">
                    <img src="https://github.com/mohamedsillahkanu/gdp-dashboard-2/raw/6c7463b0d5c3be150aafae695a4bcbbd8aeb1499/ICF-SL.jpg" alt="ICF-SL Logo" class="header-logo-main">
                </div>
                <h3>Informatics Consultancy Firm-Sierra Leone (ICF-SL)</h3>
                <p class="tagline"><em>Driving Data-Driven Solutions for Health and Development</em></p>
                <div class="header-divider"></div>
                <h1>ITN MASS CAMPAIGN DISTRIBUTION</h1>
                <p class="subtitle">Insecticide-Treated Nets — Mass Campaign System</p>
            </div>

            <!-- PARTNER LOGOS -->
            <div class="partners-section">
                <div class="partners-label">IMPLEMENTING PARTNERS</div>
                <div class="partners-grid">
                    <div class="partner-logo-card">
                        <div class="partner-logo-img"><div class="logo-placeholder-box">MoHS</div></div>
                        <span class="partner-name">Ministry of Health</span>
                    </div>
                    <div class="partner-logo-card">
                        <div class="partner-logo-img"><div class="logo-placeholder-box">NMCP</div></div>
                        <span class="partner-name">NMCP</span>
                    </div>
                    <div class="partner-logo-card">
                        <div class="partner-logo-img"><div class="logo-placeholder-box">PMI</div></div>
                        <span class="partner-name">PMI Evolve</span>
                    </div>
                </div>
            </div>

            <!-- LOGIN FORM -->
            <div class="form-card">
                <div class="form-content">
                    <div class="section-header">
                        <div class="section-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4M10 17l5-5-5-5M15 12H3"/>
                            </svg>
                        </div>
                        <div>
                            <h2 class="section-title">USER LOGIN</h2>
                            <p class="section-description">Sign in with your credentials to begin</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">USER ID <span class="required">*</span></label>
                        <input type="text" class="form-input" id="loginUserId" placeholder="Enter your User ID" autocomplete="off">
                        <div class="field-error" id="error_loginUserId"></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">PASSWORD <span class="required">*</span></label>
                        <input type="password" class="form-input" id="loginPassword" placeholder="Enter password">
                        <div class="field-error" id="error_loginPassword"></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">DISTRIBUTION POINT <span class="required">*</span></label>
                        <select class="form-select" id="loginDistPoint">
                            <option value="">Select Distribution Point...</option>
                        </select>
                        <div class="field-error" id="error_loginDistPoint"></div>
                    </div>

                    <div class="login-error-msg" id="loginError"></div>

                    <div class="navigation-buttons">
                        <button type="button" class="btn-nav btn-submit full-width" onclick="handleLogin()">
                            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4M10 17l5-5-5-5M15 12H3"/>
                            </svg>
                            SIGN IN & START
                        </button>
                    </div>
                </div>
            </div>

            <!-- FOOTER -->
            <div class="page-footer">
                <p class="footer-main">ITN Mass Campaign Distribution - Sierra Leone</p>
                <div class="footer-partners">Ministry of Health | NMCP | PMI Evolve</div>
                <p class="footer-copy">© 2025 Informatics Consultancy Firm-Sierra Leone (ICF-SL)</p>
            </div>
        </div>
    </div>

    <!-- ==================== MAIN APP SCREEN ==================== -->
    <div class="main-content" id="appScreen" style="display:none;">
        <div class="page-container">

            <!-- HEADER -->
            <div class="page-header compact">
                <div class="header-row">
                    <div class="header-left">
                        <img src="https://github.com/mohamedsillahkanu/gdp-dashboard-2/raw/6c7463b0d5c3be150aafae695a4bcbbd8aeb1499/ICF-SL.jpg" alt="ICF-SL" class="header-logo-small">
                        <div>
                            <h1 class="compact-title">ITN MASS CAMPAIGN</h1>
                            <p class="compact-subtitle">Distribution Management System</p>
                        </div>
                    </div>
                    <div class="header-right">
                        <span class="user-tag" id="userTag">USER</span>
                        <button class="logout-btn" onclick="handleLogout()" title="Log Out">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"/></svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- GEO INFO BAR -->
            <div class="geo-info-bar" id="geoBar">
                <div class="geo-chip"><span class="geo-label">District:</span><span class="geo-value" id="geoDistrict">—</span></div>
                <div class="geo-chip"><span class="geo-label">Chiefdom:</span><span class="geo-value" id="geoChiefdom">—</span></div>
                <div class="geo-chip"><span class="geo-label">Community:</span><span class="geo-value" id="geoCommunity">—</span></div>
                <div class="geo-chip highlight"><span class="geo-label">Dist. Point:</span><span class="geo-value" id="geoDP">—</span></div>
            </div>

            <!-- STATUS BAR -->
            <div class="status-bar">
                <div class="status-item">
                    <div class="status-indicator" id="statusIndicator"></div>
                    <span class="status-text" id="statusText">ONLINE</span>
                </div>
                <div class="status-item">
                    <span class="status-label">REGISTERED:</span>
                    <span class="draft-count" id="regCount">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">DISTRIBUTED:</span>
                    <span class="pending-count" id="distCount">0</span>
                </div>
            </div>

            <!-- TAB CONTROLS -->
            <div class="controls-bar tab-controls">
                <button class="control-btn active" data-tab="registration" onclick="switchTab('registration')">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="8.5" cy="7" r="4"/><path d="M20 8v6M23 11h-6"/>
                    </svg>
                    REGISTRATION
                </button>
                <button class="control-btn" data-tab="distribution" onclick="switchTab('distribution')">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/>
                    </svg>
                    DISTRIBUTION
                </button>
                <button class="control-btn" data-tab="itnreceived" onclick="switchTab('itnreceived')">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                    </svg>
                    ITN RECEIVED
                </button>
                <button class="control-btn" data-tab="dhissync" onclick="switchTab('dhissync')">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 2v6h-6M3 12a9 9 0 0115.36-6.36L21 8M3 22v-6h6M21 12a9 9 0 01-15.36 6.36L3 16"/>
                    </svg>
                    DHIS2 SYNC
                </button>
            </div>

            <!-- ==================== REGISTRATION TAB ==================== -->
            <div class="tab-panel active" id="tab-registration">
                <div class="form-card">
                    <div class="form-content">
                        <div class="section-header">
                            <div class="section-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="8.5" cy="7" r="4"/><path d="M20 8v6M23 11h-6"/>
                                </svg>
                            </div>
                            <div>
                                <h2 class="section-title">HOUSEHOLD REGISTRATION</h2>
                                <p class="section-description">Register household and scan voucher barcodes</p>
                            </div>
                        </div>

                        <form id="regForm" onsubmit="return false;">

                            <!-- Household Head Block -->
                            <div class="class-block">
                                <div class="class-header">
                                    <svg class="class-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/>
                                    </svg>
                                    HOUSEHOLD HEAD INFORMATION
                                </div>
                                <div class="class-grid">
                                    <div class="form-group" style="grid-column: span 2;">
                                        <label class="form-label">FULL NAME <span class="required">*</span></label>
                                        <input type="text" class="form-input name-field" id="reg_hh_name" placeholder="Enter household head full name" required>
                                        <div class="field-error" id="error_reg_hh_name"></div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">PHONE NUMBER <span class="required">*</span></label>
                                        <input type="tel" class="form-input phone-field" id="reg_hh_phone" placeholder="9-digit number" maxlength="9" required>
                                        <div class="field-hint">Enter 9-digit phone number</div>
                                        <div class="field-error" id="error_reg_hh_phone"></div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">HOUSEHOLD ID</label>
                                        <input type="text" class="form-input" id="reg_hh_id" readonly style="background:#e9ecef; color:#0056a8; font-weight:700;">
                                        <div class="field-hint">Auto-generated</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Household Members Block -->
                            <div class="class-block">
                                <div class="class-header">
                                    <svg class="class-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/>
                                    </svg>
                                    HOUSEHOLD MEMBERS
                                </div>
                                <div class="class-grid">
                                    <div class="form-group" style="grid-column: span 2;">
                                        <label class="form-label">TOTAL NUMBER OF PEOPLE IN HOUSEHOLD <span class="required">*</span></label>
                                        <input type="number" class="form-input" id="reg_total_people" min="1" max="50" placeholder="0" required oninput="onTotalPeopleChange()">
                                        <div class="field-error" id="error_reg_total_people"></div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">NUMBER OF MALES <span class="required">*</span></label>
                                        <input type="number" class="form-input" id="reg_males" min="0" placeholder="0" required oninput="onGenderChange()">
                                        <div class="field-error" id="error_reg_males"></div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">NUMBER OF FEMALES <span class="required">*</span></label>
                                        <input type="number" class="form-input" id="reg_females" min="0" placeholder="0" required oninput="onGenderChange()">
                                        <div class="field-error" id="error_reg_females"></div>
                                    </div>
                                </div>
                                <!-- Gender validation check -->
                                <div class="validation-note gender-check" id="genderCheck" style="display:none;">
                                    <svg class="note-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
                                    </svg>
                                    <span id="genderCheckText">Males + Females must equal total people</span>
                                </div>
                                <div class="class-grid" style="border-top: 1px solid #dee2e6;">
                                    <div class="form-group">
                                        <label class="form-label">CHILDREN UNDER 5 YEARS <span class="required">*</span></label>
                                        <input type="number" class="form-input" id="reg_under5" min="0" placeholder="0" required oninput="onVulnerableChange()">
                                        <div class="field-error" id="error_reg_under5"></div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">PREGNANT WOMEN <span class="required">*</span></label>
                                        <input type="number" class="form-input" id="reg_pregnant" min="0" placeholder="0" required oninput="onVulnerableChange()">
                                        <div class="field-error" id="error_reg_pregnant"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Voucher Allocation -->
                            <div class="dashboard-block" id="voucherSummary" style="display:none;">
                                <div class="dashboard-header">
                                    <svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="2" y="4" width="20" height="16" rx="2"/><path d="M2 10h20"/>
                                    </svg>
                                    VOUCHER ALLOCATION
                                </div>
                                <div class="dashboard-cards">
                                    <div class="dash-card green large">
                                        <div class="dash-label">Vouchers to Scan</div>
                                        <div class="dash-value big" id="voucherCount">0</div>
                                        <div class="remaining-status" id="voucherFormula">Based on household size</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Barcode Scanners -->
                            <div class="class-block" id="scannerBlock" style="display:none;">
                                <div class="class-header" style="background:#28a745;">
                                    <svg class="class-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="3" width="18" height="18" rx="2"/><path d="M7 7h3v3H7zM14 7h3v3h-3zM7 14h3v3H7z"/>
                                    </svg>
                                    SCAN VOUCHER BARCODES
                                </div>
                                <div class="scanner-area" id="scannerGrid"></div>
                            </div>

                            <!-- GPS -->
                            <div class="class-block">
                                <div class="class-header">
                                    <svg class="class-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/><circle cx="12" cy="10" r="3"/>
                                    </svg>
                                    GPS LOCATION
                                </div>
                                <div style="padding: 12px 15px;">
                                    <div class="gps-container">
                                        <div class="gps-status">
                                            <div class="gps-icon" id="regGpsDot"></div>
                                            <div>
                                                <div class="gps-info" id="regGpsText">Capturing GPS...</div>
                                                <div class="gps-coords" id="regGpsCoords"></div>
                                            </div>
                                        </div>
                                        <button type="button" class="gps-btn" onclick="captureRegGPS()">
                                            <svg class="retry-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 11-2.12-9.36L23 10"/>
                                            </svg>
                                            RETRY
                                        </button>
                                    </div>
                                    <input type="hidden" id="reg_gps_lat">
                                    <input type="hidden" id="reg_gps_lng">
                                    <input type="hidden" id="reg_gps_acc">
                                </div>
                            </div>

                            <!-- Submit -->
                            <div class="navigation-buttons">
                                <button type="button" class="btn-nav btn-submit full-width" onclick="submitRegistration()">
                                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                    REGISTER HOUSEHOLD
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- ==================== DISTRIBUTION TAB ==================== -->
            <div class="tab-panel" id="tab-distribution">
                <div class="form-card">
                    <div class="form-content">
                        <div class="section-header">
                            <div class="section-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/>
                                </svg>
                            </div>
                            <div>
                                <h2 class="section-title">ITN DISTRIBUTION</h2>
                                <p class="section-description">Scan voucher to verify and distribute ITNs</p>
                            </div>
                        </div>

                        <!-- Scan Voucher -->
                        <div class="itn-received-block">
                            <div class="itn-received-header" style="background:#28a745;">
                                <svg class="block-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/><path d="M7 7h3v3H7zM14 7h3v3h-3zM7 14h3v3H7z"/>
                                </svg>
                                SCAN VOUCHER FOR DISTRIBUTION
                            </div>
                            <div class="itn-received-content">
                                <div class="scanner-input-row">
                                    <input type="text" class="form-input scanner-input-large" id="dist_voucher_scan" placeholder="Scan or enter voucher barcode...">
                                    <button type="button" class="btn-nav btn-next" onclick="verifyVoucher()" style="min-width:120px;">
                                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/></svg>
                                        VERIFY
                                    </button>
                                </div>
                                <div class="field-hint" style="text-align:center; margin-top:8px;">Point camera at voucher barcode or type voucher number and press VERIFY</div>
                            </div>
                        </div>

                        <!-- Verification Result -->
                        <div id="verifyResultBlock" style="display:none;">
                            <div id="verifyResult"></div>
                        </div>

                        <!-- Recent Distributions -->
                        <div class="dashboard-block">
                            <div class="dashboard-header">
                                <svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 3h18v18H3zM3 9h18M9 21V9"/>
                                </svg>
                                RECENT DISTRIBUTIONS
                            </div>
                            <div class="dist-history-container" id="distHistory">
                                <div class="no-data">No distributions yet today</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==================== ITN RECEIVED TAB ==================== -->
            <div class="tab-panel" id="tab-itnreceived">
                <div class="form-card">
                    <div class="form-content">
                        <div class="section-header">
                            <div class="section-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                                </svg>
                            </div>
                            <div>
                                <h2 class="section-title">ITN STOCK RECEIVED</h2>
                                <p class="section-description">Record ITN stock received at distribution point</p>
                            </div>
                        </div>

                        <form id="itnReceivedForm" onsubmit="return false;">
                            <div class="class-block">
                                <div class="class-header">
                                    <svg class="class-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/>
                                    </svg>
                                    STOCK DETAILS
                                </div>
                                <div class="class-grid">
                                    <div class="form-group">
                                        <label class="form-label">DATE RECEIVED <span class="required">*</span></label>
                                        <input type="date" class="form-input" id="itn_recv_date" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">BATCH NUMBER</label>
                                        <input type="text" class="form-input" id="itn_batch" placeholder="e.g., BATCH-2025-001">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ITN TYPE <span class="required">*</span></label>
                                        <select class="form-select" id="itn_recv_type" required>
                                            <option value="">Select Type...</option>
                                            <option value="PBO">PBO (Piperonyl Butoxide)</option>
                                            <option value="IG2">IG2 (Interceptor G2)</option>
                                            <option value="Mixed">Mixed (PBO + IG2)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">QUANTITY RECEIVED <span class="required">*</span></label>
                                        <input type="number" class="form-input" id="itn_recv_qty" min="1" placeholder="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">RECEIVED FROM</label>
                                        <input type="text" class="form-input" id="itn_recv_from" placeholder="e.g., District Store">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">NOTES</label>
                                        <input type="text" class="form-input" id="itn_recv_notes" placeholder="Any remarks...">
                                    </div>
                                </div>
                            </div>

                            <div class="navigation-buttons">
                                <button type="button" class="btn-nav btn-submit full-width" onclick="submitITNReceived()">
                                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                    RECORD STOCK RECEIVED
                                </button>
                            </div>
                        </form>

                        <!-- Stock Summary -->
                        <div class="dashboard-block">
                            <div class="dashboard-header">
                                <svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M18 20V10M12 20V4M6 20v-6"/>
                                </svg>
                                STOCK SUMMARY
                            </div>
                            <div class="dashboard-cards">
                                <div class="dash-card blue">
                                    <div class="dash-label">Total Received</div>
                                    <div class="dash-value" id="stockReceived">0</div>
                                </div>
                                <div class="dash-card green">
                                    <div class="dash-label">Total Distributed</div>
                                    <div class="dash-value" id="stockDistributed">0</div>
                                </div>
                                <div class="dash-card orange">
                                    <div class="dash-label">Remaining</div>
                                    <div class="dash-value" id="stockRemaining">0</div>
                                </div>
                            </div>
                            <div class="stock-history-list" id="stockHistory">
                                <div class="no-data">No stock records yet</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==================== DHIS2 SYNC TAB ==================== -->
            <div class="tab-panel" id="tab-dhissync">
                <div class="form-card">
                    <div class="form-content">
                        <div class="section-header">
                            <div class="section-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 2v6h-6M3 12a9 9 0 0115.36-6.36L21 8M3 22v-6h6M21 12a9 9 0 01-15.36 6.36L3 16"/>
                                </svg>
                            </div>
                            <div>
                                <h2 class="section-title">DHIS2 SYNCHRONIZATION</h2>
                                <p class="section-description">Sync collected data with DHIS2 instance</p>
                            </div>
                        </div>

                        <!-- Sync Config -->
                        <div class="class-block">
                            <div class="class-header">
                                <svg class="class-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06"/>
                                </svg>
                                DHIS2 CONFIGURATION
                            </div>
                            <div class="class-grid">
                                <div class="form-group" style="grid-column: span 2;">
                                    <label class="form-label">DHIS2 SERVER URL</label>
                                    <input type="url" class="form-input" id="dhis2Url" placeholder="https://dhis2.example.org">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">USERNAME</label>
                                    <input type="text" class="form-input" id="dhis2User" placeholder="DHIS2 username">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">PASSWORD</label>
                                    <input type="password" class="form-input" id="dhis2Pass" placeholder="DHIS2 password">
                                </div>
                            </div>
                        </div>

                        <!-- Sync Status -->
                        <div class="dashboard-block">
                            <div class="dashboard-header" style="background:#28a745;">
                                <svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>
                                </svg>
                                SYNC STATUS
                            </div>
                            <div class="dashboard-cards" style="grid-template-columns: repeat(2, 1fr);">
                                <div class="dash-card blue">
                                    <div class="dash-label">Pending Registrations</div>
                                    <div class="dash-value" id="syncPendingReg">0</div>
                                </div>
                                <div class="dash-card pink">
                                    <div class="dash-label">Pending Distributions</div>
                                    <div class="dash-value" id="syncPendingDist">0</div>
                                </div>
                                <div class="dash-card orange">
                                    <div class="dash-label">Pending Stock Records</div>
                                    <div class="dash-value" id="syncPendingStock">0</div>
                                </div>
                                <div class="dash-card green">
                                    <div class="dash-label">Total Synced</div>
                                    <div class="dash-value" id="syncTotal">0</div>
                                </div>
                            </div>
                        </div>

                        <div class="navigation-buttons">
                            <button type="button" class="btn-nav btn-submit" onclick="syncToDHIS2()">
                                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 2v6h-6M3 12a9 9 0 0115.36-6.36L21 8"/></svg>
                                SYNC NOW
                            </button>
                            <button type="button" class="btn-nav btn-draft" onclick="exportData()">
                                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>
                                EXPORT CSV
                            </button>
                        </div>

                        <!-- Sync Log -->
                        <div class="dashboard-block">
                            <div class="dashboard-header">
                                <svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/>
                                </svg>
                                SYNC LOG
                            </div>
                            <div class="sync-log-container" id="syncLog">
                                <div class="no-data">No sync activity yet</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FOOTER -->
            <div class="page-footer">
                <p class="footer-main">ITN Mass Campaign Distribution - Sierra Leone</p>
                <div class="footer-partners">Ministry of Health | NMCP | PMI Evolve</div>
                <p class="footer-copy">© 2025 Informatics Consultancy Firm-Sierra Leone (ICF-SL)</p>
            </div>
        </div>
    </div>

    <!-- NOTIFICATION -->
    <div class="notification" id="notification"><span id="notificationText"></span></div>

    <script src="script.js"></script>
</body>
</html>
